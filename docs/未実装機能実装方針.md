# RemindFlow 未実装機能実装方針

## 概要
RemindFlowプロジェクトの精査結果に基づき、UIは存在するが機能が未実装の箇所とその実装方針をまとめました。

## 1. 設定画面機能

### 現状（更新）
- 設定画面コンポーネント `SettingsModal.jsx` を追加済み
- ヘッダーおよびダッシュボードから起動可能
- JSONバックアップ/インポート、CSVエクスポートを提供

### 実装方針
1. **設定画面コンポーネントの作成**
   - `src/components/Settings/SettingsModal.jsx`を作成
   - 通知設定、表示設定、データ管理の3つのタブで構成

2. **実装した機能**
   - 通知設定（有効/無効、デフォルト通知時間、通知音、表示秒数）
   - 表示設定（テーマ、フォントサイズ）
   - データ管理（CSVエクスポート、JSONバックアップ/インポート）

3. **実装手順**
```javascript
// App.jsxの修正
const [settingsOpen, setSettingsOpen] = useState(false);

const handleSettingsOpen = () => {
  setSettingsOpen(true);
};
```

## 2. 通知機能の完全実装

### 現状（更新）
- `useNotifications.js`/`notifications.ts` 実装済み
- 通知ON/OFF切り替えを設定モーダルから利用可能
- 通知音ファイルは `public/sounds/{chime,bell,notification}.mp3` を配置すれば有効（リポジトリ同梱済）
- ヘッダー通知メニュー：当日これからのリマインダーが1件以上で赤ドット表示
- 通知履歴の保存・閲覧を実装（最新100件、既読化・全削除対応）

### 実装方針
1. **通知音ファイルの追加**
   - `public/sounds/`ディレクトリに `chime.mp3`, `bell.mp3`, `notification.mp3`

2. **通知状態の視覚化**
   - ヘッダーの通知アイコンに当日残りリマインダー数の赤ドット（実装済）
   - 通知履歴の表示（実装済）

3. **実装手順**
```javascript
// 通知音ファイルの配置
public/sounds/
├── chime.mp3
├── bell.mp3
└── notification.mp3
```

## 3. 繰り返し予定の生成機能

### 現状（更新）
- `App.jsx` の保存処理で、終了日指定がある繰り返し予定を自動生成（`generateRecurringSchedules`）

### 実装方針（結果）
1. **繰り返し予定の自動生成**
   - 予定保存時に繰り返し設定をチェックし、終了日まで自動生成（実装済み）

2. **実装手順**
```javascript
// App.jsx の保存処理抜粋
if (scheduleData.recurrence && scheduleData.recurrence.type !== 'none' && scheduleData.recurrence.endDate) {
  const recurrences = generateRecurringSchedules(saved, scheduleData.recurrence.endDate);
  if (recurrences && recurrences.length > 0) {
    recurrences.forEach(s => addSchedule({ status: 'pending', ...s }));
  }
}
```

## 4. データエクスポート/インポート機能

### 現状（更新）
- 設定モーダルからCSVエクスポート、JSONバックアップ/インポートが可能
- CSV列は「件名/日付/開始時間/終了時間/カテゴリ/優先度/ステータス/詳細」（`utils/storage.ts`）
- ICS形式（.ics）のエクスポートに対応（設定モーダルから実行可能）

### 宀装方針
1. **エクスポート機能**
   - CSV形式でのエクスポート
   - ICS（iCalendar）形式でのエクスポート
   - JSON形式でのバックアップエクスポート

2. **インポート機能**
   - JSONファイルの読み込み（予定と設定）
   - データの検証とマージ

3. **実装手順**
```javascript
// SettingsModal.jsx にて
<Button variant="outline" onClick={handleExportCSV}>CSVエクスポート</Button>
<Button variant="outline" onClick={handleExportJSON}>JSONバックアップ</Button>
<Input type="file" accept="application/json" onChange={handleImportJSON} />
```

## 5. 検索・フィルタリング機能の改善

### 現状（更新）
- 基本的な検索・フィルタリングは実装済み（カテゴリ/優先度/日付範囲）
- 高度な検索機能（日付範囲・AND/OR）は一覧画面に実装済み

### 実装方針
1. **高度な検索機能**
   - 日付範囲での検索（開始/終了）に対応
   - AND/ORモードの切替に対応（今後他条件のOR拡張に対応可能）

2. **実装手順**
   ```javascript
   // ListView.jsxの拡張
   const [advancedFilters, setAdvancedFilters] = useState({
     dateRange: { start: '', end: '' },
     searchMode: 'AND' // 'AND' or 'OR'
   });
   ```

## 6. ダッシュボードのクイックアクション

### 現状（更新）
- ダッシュボードの「カレンダー表示」「通知設定」ボタンを実装済み
- 「直近の予定」枠の表示条件（実装済み）
  - 対象: フィルタ適用後の `schedules`
  - 範囲: 今日より後、7日以内（今日除外）
  - 並び: 日付→時間の昇順
  - 件数: 最大5件

## 9. 追加実装（本ドキュメント初版以降）

- 終了時間の入力とバリデーションを追加（`ScheduleForm.jsx`）
- 予定の完了ステータス（pending/completed）とトグル操作を追加（`ScheduleCard.jsx`）
- 一覧にステータスフィルタを追加（`ListView.jsx`）
- ヘッダーの通知メニューと赤ドット表示条件を追加（`Header.jsx` + `App.jsx`）
- CSV項目に開始/終了時間とステータスを追加（`utils/storage.ts`）

## 7. レスポンシブデザインの改善

### 現状
- 基本的なレスポンシブデザインは実装済み
- モバイルでの操作性に改善の余地

### 実装方針
1. **モバイル最適化**
   - タッチ操作の改善
   - モバイル専用のUI調整

2. **実装手順**
   - タッチフレンドリーなボタンサイズの調整
   - スワイプジェスチャーの追加検討

## 8. エラーハンドリングの強化

### 現状
- 基本的なエラーハンドリングは実装済み
- ユーザーフレンドリーなエラーメッセージが不十分

### 実装方針
1. **エラーメッセージの改善**
   - 日本語での分かりやすいエラーメッセージ
   - エラー時の復旧手順の提示

2. **実装手順**
   ```javascript
   // エラーメッセージの統一
   const ERROR_MESSAGES = {
     STORAGE_FULL: 'ストレージの容量が不足しています。古いデータを削除してください。',
     NETWORK_ERROR: 'ネットワークエラーが発生しました。しばらく待ってから再試行してください。'
   };
   ```

## 実装優先度（更新）

### 高優先度（更新）
1. 通知履歴/未読バッジ表示（履歴は未実装）
2. 通知音ファイルの同梱またはCDN提供（音源は同梱済だがCDN検討余地）
3. 高度検索（AND/OR・日付範囲保存）

### 中優先度（更新）
4. icsエクスポート/インポート対応
5. レスポンシブ操作性の微調整

### 低優先度（更新）
6. 検索・フィルタリング機能の改善
7. レスポンシブデザインの改善
8. エラーハンドリングの強化

## 実装時の注意点

1. **既存コードとの整合性**
   - 既存の型定義（`types/index.ts`）を活用
   - 既存のフック（`useSchedules`, `useNotifications`）を拡張

2. **ユーザビリティ**
   - 日本語での分かりやすいUI
   - 直感的な操作性

3. **パフォーマンス**
   - 大量データでの動作確認
   - メモリリークの防止

4. **テスト**
   - 各機能の単体テスト
   - 統合テストの実施

## 完了後の期待効果

1. **機能の完全性**
   - 予定管理アプリとして必要な機能が全て実装される
   - ユーザーが期待する機能が提供される

2. **ユーザビリティの向上**
   - 直感的で使いやすいインターフェース
   - 効率的な予定管理が可能

3. **保守性の向上**
   - 適切なエラーハンドリング
   - 拡張しやすいコード構造
